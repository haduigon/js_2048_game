const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.board=t,this.score=0,this.status="idle",this.cells=document.getElementsByClassName("field-row"),this.scoreElement=document.getElementsByClassName("game-score"),this.count=0}moveLeft(){if(this._checkNextStep(this.board,"left")){for(let t=0;t<=this.board.length-1;t++)this._compress(this.board[t]),this._merge(this.board[t]),this._compress(this.board[t]);this._renderBoard(),this._generateNumbers()}}moveRight(){if(this._checkNextStep(this.board,"right")){for(let t=0;t<=this.board.length-1;t++)this._compressDown(this.board[t]),this._mergeDown(this.board[t]),this._compressDown(this.board[t]);this._renderBoard(),this._generateNumbers()}}moveUp(){if(this._checkNextStep(this.board,"up")){for(let t=0;t<this.board[0].length;t++){let e=this.board.map(e=>e[t]);this._compress(e),this._merge(e),this._compress(e);for(let s=0;s<this.board.length;s++)this.board[s][t]=e[s]}this._generateNumbers(),this._renderBoard()}}moveDown(){if(this._checkNextStep(this.board,"down")){for(let t=0;t<this.board[0].length;t++){let e=this.board.map(e=>e[t]);this._compressDown(e),this._mergeDown(e),this._compressDown(e);for(let s=0;s<this.board.length;s++)this.board[s][t]=e[s]}this._generateNumbers(),this._renderBoard()}}_checkMoveDown(t){for(let e=0;e<t[0].length;e++){let s=t.map(t=>t[e]);this._compressDown(s),this._mergeDown(s),this._compressDown(s);for(let r=0;r<t.length;r++)t[r][e]=s[r]}}_checkMoveUp(t){for(let e=0;e<t[0].length;e++){let s=t.map(t=>t[e]);this._compress(s),this._merge(s),this._compress(s);for(let r=0;r<t.length;r++)t[r][e]=s[r]}}_checkMoveLeft(t){for(let e=0;e<=t.length-1;e++)this._compress(t[e]),this._merge(t[e]),this._compress(t[e])}_checkMoveRight(t){for(let e=0;e<=t.length-1;e++)this._compressDown(t[e]),this._mergeDown(t[e]),this._compressDown(t[e])}_checkNextStep(t,e){let s=t.map(t=>t.slice());switch(e){case"down":this._checkMoveDown(s);break;case"up":this._checkMoveUp(s);break;case"left":this._checkMoveLeft(s);break;case"right":this._checkMoveRight(s)}for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length;e++)if(this.board[t][e]!==s[t][e])return!0;return!1}_merge(t){for(let e=0;e<=t.length-1;e++)t[e]===t[e+1]&&t[e]>0&&(t[e]*=2,t[e+1]=0,this.score+=t[e]/2)}_mergeDown(t){for(let e=t.length-1;e>0;e--)t[e]===t[e-1]&&t[e]>0&&(t[e]*=2,t[e-1]=0,this.score+=t[e]/2)}_compress(t){let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);t.forEach(function(t,s,r){r[s]=e[s]})}_compressDown(t){let e=t.filter(t=>0!==t);for(;e.length<4;)e.unshift(0);t.forEach(function(t,s,r){r[s]=e[s]})}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){"idle"===this.status&&(this.board[Math.floor(4*Math.random())][Math.floor(4*Math.random())]=2,this.board[Math.floor(4*Math.random())][Math.floor(4*Math.random())]=2),14!==this._getEmptyCells().length&&this.start(),this.status="playing",this._renderBoard()}_getEmptyCells(){let t=[];for(let e=0;e<=this.board.length-1;e++)for(let s=0;s<=this.board[e].length-1;s++)0===this.board[e][s]&&t.push([e,s]);return t}restart(){this.count>0&&(this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.status="playing",this.board[Math.floor(4*Math.random())][Math.floor(4*Math.random())]=2,this.board[Math.floor(4*Math.random())][Math.floor(4*Math.random())]=2,this._renderBoard()),this.count=0,this.score=0}_generateNumbers(){let t=this._getEmptyCells();this.count++;let e=Math.floor(Math.random()*t.length),s=t[e];void 0!==s&&(this.board[s[0]][s[1]]=this._getNumber()),this._renderBoard()}_renderBoard(){let t=document.getElementById("start-button"),e=document.getElementById("message-container");for(let t=0;t<=this.board.length-1;t++)for(let e=0;e<=this.board[t].length-1;e++)this.cells[t].cells[e].innerText=this.board[t][e],this.cells[t].cells[e].classList.value=`field-cell field-cell--${this.cells[t].cells[e].innerText}`,0===this.board[t][e]&&(this.cells[t].cells[e].innerText="");"playing"===this.status&&(t.innerText="Restart",t.classList.add("restart")),"playing"===this.status&&(e.children[2].classList.add("hidden"),e.children[1].classList.add("hidden"),e.children[0].classList.add("hidden")),this.board.some(t=>t.some(t=>2048===t))&&e.children[1].classList.remove("hidden"),this._checkLoose()||(this.status="lose",e.children[0].classList.remove("hidden")),this.scoreElement[0].innerText=this.score}_getNumber(){let t=[2,2,2,2,2,2,2,2,2,4],e=Math.floor(Math.random()*t.length);return t[e]}_checkLoose(){if(this.board.some(t=>t.some(t=>0===t)))return!0;for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length;e++)if(e<this.board[t].length-1&&this.board[t][e]===this.board[t][e+1]||t<this.board[t].length-1&&this.board[t][e]===this.board[t+1][e])return!0;return!1}}([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);document.getElementById("start-button").addEventListener("click",()=>{"idle"===t.getStatus()?t.start():t.restart()}),window.addEventListener("keyup",function(e){"ArrowUp"===e.code&&t.moveUp(),"ArrowDown"===e.code&&t.moveDown(),"ArrowLeft"===e.code&&t.moveLeft(),"ArrowRight"===e.code&&t.moveRight()});
//# sourceMappingURL=index.bfbc7730.js.map
