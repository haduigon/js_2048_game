!function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var t=new(function(){var t,r;function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,o),this.board=e,this.score=0,this.status="idle",this.cells=document.getElementsByClassName("field-row"),this.scoreElement=document.getElementsByClassName("game-score"),this.count=0}return t=[{key:"moveLeft",value:function(){if(this._checkNextStep(this.board,"left")){for(var e=0;e<=this.board.length-1;e++)this._compress(this.board[e]),this._merge(this.board[e]),this._compress(this.board[e]);this._renderBoard(),this._generateNumbers()}}},{key:"moveRight",value:function(){if(this._checkNextStep(this.board,"right")){for(var e=0;e<=this.board.length-1;e++)this._compressDown(this.board[e]),this._mergeDown(this.board[e]),this._compressDown(this.board[e]);this._renderBoard(),this._generateNumbers()}}},{key:"moveUp",value:function(){if(this._checkNextStep(this.board,"up")){for(var e=this,t=function(t){var r=e.board.map(function(e){return e[t]});e._compress(r),e._merge(r),e._compress(r);for(var o=0;o<e.board.length;o++)e.board[o][t]=r[o]},r=0;r<this.board[0].length;r++)t(r);this._generateNumbers(),this._renderBoard()}}},{key:"moveDown",value:function(){if(this._checkNextStep(this.board,"down")){for(var e=this,t=function(t){var r=e.board.map(function(e){return e[t]});e._compressDown(r),e._mergeDown(r),e._compressDown(r);for(var o=0;o<e.board.length;o++)e.board[o][t]=r[o]},r=0;r<this.board[0].length;r++)t(r);this._generateNumbers(),this._renderBoard()}}},{key:"_checkMoveDown",value:function(e){for(var t=this,r=function(r){var o=e.map(function(e){return e[r]});t._compressDown(o),t._mergeDown(o),t._compressDown(o);for(var n=0;n<e.length;n++)e[n][r]=o[n]},o=0;o<e[0].length;o++)r(o)}},{key:"_checkMoveUp",value:function(e){for(var t=this,r=function(r){var o=e.map(function(e){return e[r]});t._compress(o),t._merge(o),t._compress(o);for(var n=0;n<e.length;n++)e[n][r]=o[n]},o=0;o<e[0].length;o++)r(o)}},{key:"_checkMoveLeft",value:function(e){for(var t=0;t<=e.length-1;t++)this._compress(e[t]),this._merge(e[t]),this._compress(e[t])}},{key:"_checkMoveRight",value:function(e){for(var t=0;t<=e.length-1;t++)this._compressDown(e[t]),this._mergeDown(e[t]),this._compressDown(e[t])}},{key:"_checkNextStep",value:function(e,t){var r=e.map(function(e){return e.slice()});switch(t){case"down":this._checkMoveDown(r);break;case"up":this._checkMoveUp(r);break;case"left":this._checkMoveLeft(r);break;case"right":this._checkMoveRight(r)}for(var o=0;o<this.board.length;o++)for(var n=0;n<this.board[o].length;n++)if(this.board[o][n]!==r[o][n])return!0;return!1}},{key:"_merge",value:function(e){for(var t=0;t<=e.length-1;t++)e[t]===e[t+1]&&e[t]>0&&(e[t]*=2,e[t+1]=0,this.score+=e[t]/2)}},{key:"_mergeDown",value:function(e){for(var t=e.length-1;t>0;t--)e[t]===e[t-1]&&e[t]>0&&(e[t]*=2,e[t-1]=0,this.score+=e[t]/2)}},{key:"_compress",value:function(e){for(var t=e.filter(function(e){return 0!==e});t.length<4;)t.push(0);e.forEach(function(e,r,o){o[r]=t[r]})}},{key:"_compressDown",value:function(e){for(var t=e.filter(function(e){return 0!==e});t.length<4;)t.unshift(0);e.forEach(function(e,r,o){o[r]=t[r]})}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){"idle"===this.status&&(this.board[Math.floor(4*Math.random())][Math.floor(4*Math.random())]=2,this.board[Math.floor(4*Math.random())][Math.floor(4*Math.random())]=2),14!==this._getEmptyCells().length&&this.start(),this.status="playing",this._renderBoard()}},{key:"_getEmptyCells",value:function(){for(var e=[],t=0;t<=this.board.length-1;t++)for(var r=0;r<=this.board[t].length-1;r++)0===this.board[t][r]&&e.push([t,r]);return e}},{key:"restart",value:function(){this.count>0&&(this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.status="playing",this.board[Math.floor(4*Math.random())][Math.floor(4*Math.random())]=2,this.board[Math.floor(4*Math.random())][Math.floor(4*Math.random())]=2,this._renderBoard()),this.count=0,this.score=0}},{key:"_generateNumbers",value:function(){var e=this._getEmptyCells();this.count++;var t=Math.floor(Math.random()*e.length),r=e[t];void 0!==r&&(this.board[r[0]][r[1]]=this._getNumber()),this._renderBoard()}},{key:"_renderBoard",value:function(){for(var e=document.getElementById("start-button"),t=document.getElementById("message-container"),r=0;r<=this.board.length-1;r++)for(var o=0;o<=this.board[r].length-1;o++)this.cells[r].cells[o].innerText=this.board[r][o],this.cells[r].cells[o].classList.value="field-cell field-cell--".concat(this.cells[r].cells[o].innerText),0===this.board[r][o]&&(this.cells[r].cells[o].innerText="");"playing"===this.status&&(e.innerText="Restart",e.classList.add("restart")),"playing"===this.status&&(t.children[2].classList.add("hidden"),t.children[1].classList.add("hidden"),t.children[0].classList.add("hidden")),this.board.some(function(e){return e.some(function(e){return 2048===e})})&&t.children[1].classList.remove("hidden"),this._checkLoose()||(this.status="lose",t.children[0].classList.remove("hidden")),this.scoreElement[0].innerText=this.score}},{key:"_getNumber",value:function(){var e=[2,2,2,2,2,2,2,2,2,4],t=Math.floor(Math.random()*e.length);return e[t]}},{key:"_checkLoose",value:function(){if(this.board.some(function(e){return e.some(function(e){return 0===e})}))return!0;for(var e=0;e<this.board.length;e++)for(var t=0;t<this.board[e].length;t++)if(t<this.board[e].length-1&&this.board[e][t]===this.board[e][t+1]||e<this.board[e].length-1&&this.board[e][t]===this.board[e+1][t])return!0;return!1}}],e(o.prototype,t),r&&e(o,r),o}())([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);document.getElementById("start-button").addEventListener("click",function(){"idle"===t.getStatus()?t.start():t.restart()}),window.addEventListener("keyup",function(e){"ArrowUp"===e.code&&t.moveUp(),"ArrowDown"===e.code&&t.moveDown(),"ArrowLeft"===e.code&&t.moveLeft(),"ArrowRight"===e.code&&t.moveRight()})}();
//# sourceMappingURL=index.aafdfb45.js.map
